
Міністерство освіти і науки України
Харківський національний університет радіоелектроніки
Кафедра програмної інженерії



Звіт
з практичної роботи №2
з дисципліни «Аналіз та рефакторінг коду»






Виконав:                                                           Перевірив:
ст. гр. ПЗПІ 23-7                                              Старший викладач кафедри ПІ
Максименко Марко                                         Сокорчук І.П.
Віталійович                          
                                                                       









Харків 2025
ІСТОРІЯ ЗМІН
№
Дата звернення
Версія звіту
Опис змін та виправлень
1
05.11.25
1.1
Створено розділ «Мета роботи» та коротко описано поняття рефакторингу й його доцільність.
2
07.11.25
1.2


Додано розділ «Хід роботи» з описом методів Move Method, Encapsulate Field та Replace Temp with Query.

3
09.11.25
1.3


Додано приклади з кодом до кожного методу рефакторингу.

4
11.11.25
1.4
Оновлено висновки та сформовано розділ «Використані джерела».

Мета роботи
Метою роботи є дослідження та систематизація трьох методів рефакторингу коду програмного забезпечення — Move Method, Encapsulate Field та Replace Temp with Query — на прикладі об’єктно-орієнтованих програм, а також демонстрація того, як ці техніки допомагають покращити структуру коду, підвищити його читабельність, зменшити зв’язність між компонентами та спростити підтримку без зміни зовнішньої поведінки програми.
Рефакторинг розглядається як систематичний процес покращення внутрішнього дизайну коду без додавання нової функціональності, що є особливо важливим для довготривалих та масштабованих програмних проєктів
Хід роботи
Вибір та обґрунтування теми (Слайди 2–3)
Рефакторинг — це процес поліпшення внутрішньої структури програмного коду без зміни його зовнішньої поведінки. З часом будь-яка програма ускладнюється: додаються нові функції, змінюються вимоги, з’являються тимчасові рішення. У результаті код стає важким для читання, містить дублювання логіки та зайві залежності між класами.
Для зменшення технічного боргу використовуються спеціальні методи рефакторингу. У цій роботі, відповідно до презентації, було обрано три методи:
• Move Method — переміщення методу до того класу, де він логічно має знаходитися;
• Encapsulate Field — інкапсуляція публічних полів за допомогою геттерів/сеттерів;
• Replace Temp with Query — заміна тимчасової змінної викликом методу-запиту.
Ці методи дають змогу:
• зменшити залежності між класами;
• зробити структуру коду більш прозорою;
• спростити тестування та подальший розвиток систем
Метод 1: Add Parameter (Слайди 4–6)
Опис методу
Move Method застосовується тоді, коли певний метод частіше працює з даними іншого класу, ніж власного. Це означає, що метод «живе» не у своєму класі, а логічно належить іншому.
Проблема:
• Метод знаходиться в класі А, але використовуює переважно поля та методи класу B.
• Зростає зв’язність між класами: клас А «знає забагато» про структуру B.
• Зміни в B можуть вимагати численних правок у A.
Ідея рефакторингу: перенести метод туди, де знаходяться основні дані, з якими він працює — зазвичай у клас B. Це підвищує згуртованість (cohesion) і зменшує зв’язність (coupling).


public class Order
{
    public decimal Total { get; set; }
    public bool IsVipCustomer { get; set; }
}

public class OrderService
{
    // Метод живе в сервісі, але працює лише з даними Order
    public decimal CalculateDiscount(Order order)
    {
        if (order.IsVipCustomer)
        {
            return order.Total * 0.9m;
        }

        return order.Total;
    }
}
Приклад коду до рефакторингу (Move Method)
У цьому прикладі логіка розрахунку знижки знаходиться у OrderService, хоча використовуються тільки поля об’єкта Order.

public class Order
{
    public decimal Total { get; set; }
    public bool IsVipCustomer { get; set; }

    // Метод перенесено до класу, де зберігаються відповідні дані
    public decimal GetTotalWithDiscount()
    {
        if (IsVipCustomer)
        {
            return Total * 0.9m;
        }

        return Total;
    }
}

public class OrderService
{
    public decimal CalculateDiscount(Order order)
    {
        // Сервіс лише делегує виклик об’єкту Order
        return order.GetTotalWithDiscount();
    }
}
Приклад коду після рефакторингу (Move Method)

Метод 2: Encapsulate Field (Слайди 7–9)
Опис методу
Encapsulate Field використовується, коли поля класу оголошені публічними (public) і до них є прямий доступ з будь-якої частини програми. Це порушує принцип інкапсуляції: немає контролю над тим, хто і як змінює значення поля.
Проблема:
• Будь-який код може напряму змінювати поле.
• Неможливо додати валідацію, логування або перевірку допустимості значення.
• Складно відстежити, звідки прийшло некоректне значення.
Ідея рефакторингу: зробити поле приватним (private) і надати доступ через властивість або методи get/set, де можна реалізувати логіку перевірки.

public class Product
{
    // Публічне поле: будь-хто може встановити будь-яке значення
    public decimal Price;
}
Приклад коду до рефакторингу (Encapsulate Field)
Десь у коді:
var product = new Product();
product.Price = -100; // Немає жодної перевірки, можлива від’ємна ціна
Така реалізація небезпечна — будь-який негативний або нульовий Price легко «пролізе» у бізнес-логіку.

public class Product
{
    private decimal _price;

    public decimal Price
    {
        get => _price;
        set
        {
            if (value < 0)
            {
                throw new ArgumentException("Ціна не може бути від’ємною.");
            }

            _price = value;
        }
    }
}  
Приклад коду після рефакторингу (Encapsulate Field)
Використання:
var product = new Product();
product.Price = 250m;       // Коректне значення
// product.Price = -100m;   // Викличе виняток через некоректну ціну
Переваги застосування Encapsulate Field:
• Доступ до поля стає контрольованим.
• З’являється можливість в одному місці додати перевірку, логування, перерахунок пов’язаних даних.
• Внутрішнє представлення можна змінювати без зміни зовнішнього інтерфейсу класу.

Метод 3: Replace Temp with Query (Слайди 10–12)
Опис методу
Replace Temp with Query застосовується, коли тимчасова змінна (temp, result, basePrice тощо) зберігає результат складного виразу, який часто використовується або дублюється в різних частинах коду.
Проблема:
• У методі є тимчасова змінна з проміжним результатом.
• Вираз, який обчислює це значення, дублюється.
• Метод «роздувається», містить багато локальних змінних і стає важким для читання.
Ідея рефакторингу: винести складний вираз в окремий метод-запит (query) і замінити використання тимчасової змінної викликом цього методу.
public class Order
{
    public int Quantity { get; set; }
    public decimal ItemPrice { get; set; }

    public decimal GetFinalPrice()
    {
        decimal basePrice = Quantity * ItemPrice;

        if (basePrice > 1000)
        {
            return basePrice * 0.9m;
        }

        return basePrice;
    }
}
Приклад коду до рефакторингу (Replace Temp with Query)
Тут вираз Quantity * ItemPrice захардкожений у методі й зберігається в змінній basePrice. Якщо базова ціна потрібна в іншому місці, доведеться повторювати цей вираз.

Приклад коду після рефакторингу (Replace Temp with Query)

public class Order
{
    public int Quantity { get; set; }
    public decimal ItemPrice { get; set; }

    public decimal GetFinalPrice()
    {
        decimal basePrice = GetBasePrice();

        if (basePrice > 1000)
        {
            return basePrice * 0.9m;
        }

        return basePrice;
    }

    // Складний вираз винесено в окремий метод-запит
    private decimal GetBasePrice()
    {
        return Quantity * ItemPrice;
    }
}
Переваги застосування Replace Temp with Query:
• Зникає дублювання складного виразу.
• Код стає самодокументованим — із назви методу GetBasePrice() видно, що він обчислює.
• Змінити логіку розрахунку базової ціни можна в одному місці, не шукаючи всі тимчасові змінні.

Висновки (Слайд 13)
У результаті виконання практичної роботи за матеріалами презентації було розглянуто три ключові методи рефакторингу: Move Method, Encapsulate Field та Replace Temp with Query.
Отримані результати показують, що систематичне застосування цих технік:
• підвищує читабельність та зрозумілість коду;
• зменшує залежності між компонентами системи;
• полегшує тестування та розширення функціоналу;
• сприяє дотриманню принципів якісної об’єктно-орієнтованої розробки.
Кожен із розглянутих методів допомагає боротися з типово́ю проблемою:
• Move Method — із неправильно розміщеною логікою;
• Encapsulate Field — із порушенням інкапсуляції;
• Replace Temp with Query — із надмірною кількістю тимчасових змінних і дублюванням виразів.
Таким чином, рефакторинг є невід’ємною частиною професійної розробки програмного забезпечення та має виконуватися регулярно паралельно з розширенням функціональності системи.

Використані джерела
1. Martin Fowler. Refactoring: Improving the Design of Existing Code. Addison-Wesley, 2018.
2. Refactoring.Guru. Refactoring Techniques Catalog.
URL: https://refactoring.guru/refactoring/techniques
3. Refactoring.Guru. Move Method.
URL: https://refactoring.guru/move-method
4. Refactoring.Guru. Encapsulate Field.
URL: https://refactoring.guru/encapsulate-field
5. Refactoring.Guru. Replace Temp with Query.
URL: https://refactoring.guru/replace-temp-with-query
6. Refactoring.Guru. Refactoring: Clean Your Code.
URL: https://refactoring.guru/refactoring

Додаток А
Посилання на відео: https://youtu.be/QGg-Jobkl2Q
Хронологічний опис відеозапису:
0:00 - Титульна сторінка
0:31 - Вступ
1:10 - Мета та доцільність рефакторингу
1:58 - Метод 1: Move MethodField (опис)
3:03 - Move MethodField (до рефакторингу)
3:50 - Move MethodField (після рефакторингу)
4:27 - Метод 2: Encapsulate Field (опис)
5:21 - Encapsulate Field (до рефакторингу)
5:50 - Encapsulate Field (після рефакторингу)
6:25 - Метод 3: Replace Temp with Query (опис)
7:15 - Replace Temp with Query (до рефакторингу)
7:44 - Replace Temp with Query (після рефакторингу)
8:13 – Висновки









Додаток Б
Слайди презентації:

Рис. Б.1 – Титульна сторінка


Рис. Б.2 – Методи рефакторингу коду програмного забезпечення


Рис. Б.3 – Що таке рефакторинг


Рис. Б.4 – Метод 1: Move MethodField (опис)

Рис. Б.5 – Move MethodField (до рефакторингу)


Рис. Б.6 – Move MethodField (після рефакторингу)


Рис. Б.7 – Метод 2: Encapsulate Field (опис)


Рис. Б.8 – Encapsulate Field (до рефакторингу)


Рис. Б.9 – Encapsulate Field (після рефакторингу)

Рис. Б.10 –  Метод 3: Replace Temp with Query (опис)


Рис. Б.11 – Replace Temp with Query (до рефакторингу)


Рис. Б.12 – Replace Temp with Query (після рефакторингу)

Рис. Б.13 – Висновки




